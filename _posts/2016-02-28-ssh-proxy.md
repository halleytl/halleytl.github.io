---
layout: post
title: "ssh 正向反向代理应用实战"
description: ""
category: 
tagline: 因为有用所以搬过来
theme:
  name: twitter
tags: [ssh, proxy]

---
{% include JB/setup %}

|机器类型|用户名|机器IP|机器端口
|--|
|需要被连接的客户端A|user_a|内网ip 192.168.1.2|22（ssh默认端口）
|中间代理服务器B|proxy_b|B.B.B|2222:A与B通信端口(反向代理), 2223:与本机2222端口通信端口（正向代理
|连接A用户的机器C|--|--|--



```shell
# 建立 ssh反向代理到外网服务器
ssh -fCNR 2222:localhost:22 proxy_b@118.118.118.118
# 建立 ssh正向代理 
ssh -fCNL "*:2223:localhost:2222" localhost
# C 机器本地执行
ssh -p 2223 user_a@B.B.B.B
```

SSH 参数解释

    -f 后台运行
    -C 允许压缩数据
    -N 不执行任何命令
    -R 将端口绑定到远程服务器，反向代理
    -L 将端口绑定到本地客户端，正向代理


产考:
    [从外网 SSH 进局域网，反向代理+正向代理解决方案](https://segmentfault.com/a/1190000002718360)

